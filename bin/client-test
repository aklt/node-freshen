#!/usr/bin/env coffee

Client = require '../lib/Client'

c1 = new Client

for arg, i in process.argv
  if /^list/.test arg
    return c1.listWorkers (err, data) ->
      console.log err, data
      process.exit 0
  if /^add|load/.test arg and process.argv[i + 1]
    return c1.addWorker process.argv[i + 2], (err, childp) ->
      console.log err
  if /^del|^rem/.test(arg) and process.argv[i + 1]
    console.log process.argv
    return c1.removeWorker parseInt(process.argv[i + 1], 10), (err, data) ->
      console.log err, data
  if /^clo|^sto/.test arg
    return c1.stop (err, data) ->
      console.log 'closed'
  if /^start-children/.test arg
    return c1.restart (err, data) ->
      console.log 'restarted', data
